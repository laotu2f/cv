<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bảng Công việc Hàng Ngày</title>
    <style>
      /* Giữ nguyên toàn bộ CSS cũ */
      #login-container {
        text-align: center;
        margin-top: 100px;
        background: linear-gradient(135deg, #74ebd5, #acb6e5);
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
        color: white;
      }
      #login-container h2 {
        color: #fff;
        font-size: 28px;
      }
      #login-container input[type="text"] {
        width: 80%;
        padding: 10px;
        border: none;
        border-radius: 5px;
        margin-top: 10px;
        font-size: 18px;
      }
      #login-container button {
        padding: 10px 20px;
        font-size: 18px;
        background-color: #fff;
        color: #007bff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease;
        margin-top: 10px;
      }
      #login-container button:hover {
        background-color: #f1f1f1;
      }
      .motivation {
        font-style: italic;
        margin-top: 20px;
        color: #fff;
        font-size: 18px;
      }
      body {
        font-family: Arial, sans-serif;
        padding: 10px;
        background-color: #f0f2f5;
      }
      h2 {
        text-align: center;
        color: #333;
        font-weight: bold;
        margin-bottom: 20px;
      }
      table {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        border-collapse: collapse;
        background: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      table,
      th,
      td {
        border: 1px solid #ddd;
      }
      th,
      td {
        padding: 10px;
        text-align: center;
      }
      select,
      input[type="text"],
      input[type="number"] {
        width: 90%;
        padding: 5px;
        box-sizing: border-box;
        margin-top: 5px;
      }
      .details {
        display: none;
      }
      .details.active {
        display: block;
      }
      .hidden {
        display: none;
      }
      .details-container {
        text-align: left;
        margin-top: 5px;
      }
      .summary {
        width: 90%;
        max-width: 800px;
        margin: 20px auto;
        background: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        padding: 15px;
        border-radius: 5px;
      }
      .summary h3 {
        text-align: center;
        color: #007bff;
      }
      .summary p {
        font-size: 16px;
        margin: 5px 0;
      }
      .pt-row {
        background-color: #c8e6c9;
      }
      .setup-row {
        background-color: #ffe082;
      }
      .appt-row {
        background-color: #bbdefb;
      }
      .off-row {
        background-color: #e0e0e0;
      }
      .call-row {
        background-color: #f8bbd0;
      }
      .train-row {
        background-color: #d1c4e9;
      }
      .fl-row {
        background-color: #b2ebf2;
      }
      .eat-row {
        background-color: #ffccbc;
      }
      .floor-row {
        background-color: #c5cae9;
      }
      .custom-row {
        background-color: #f5f5f5;
      }
      @media screen and (max-width: 600px) {
        table {
          width: 100%;
          font-size: 14px;
        }
        select,
        input[type="text"],
        input[type="number"] {
          width: 90%;
        }
      }
      #submit-btn {
        padding: 15px 30px;
        font-size: 18px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      #submit-btn:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
      #notification {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 20px;
        color: white;
        border-radius: 5px;
        display: none;
        z-index: 1000;
      }
      .copy-success {
        background-color: #28a745;
        animation: bounce 0.5s ease;
      }
      @keyframes bounce {
        0% { transform: translateX(-50%) translateY(0); }
        50% { transform: translateX(-50%) translateY(-10px); }
        100% { transform: translateX(-50%) translateY(0); }
      }
      /* CSS mới cho ô nhập liệu, tinh chỉnh để đồng nhất và đẹp hơn, căn trái */
      .monthly-inputs {
        width: 90%;
        max-width: 800px;
        margin: 20px auto;
        text-align: left; /* Giữ nguyên căn trái */
        background: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 15px;
        border-radius: 5px;
      }
      .monthly-inputs label {
        display: block; /* Giữ nguyên để căn trái */
        margin: 10px 0; /* Điều chỉnh margin để phù hợp */
        font-weight: bold;
        color: #333;
        vertical-align: middle;
      }
      .monthly-inputs input {
        width: 200px; /* Giữ nguyên kích thước input */
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
        text-align: left;
        vertical-align: middle;
      }
      /* Xóa phần CSS liên quan đến tooltip vì không cần nữa */
    </style>
  </head>
  <body>
    <div id="login-container">
      <h2>Chào mừng PT!</h2>
      <p class="motivation">Một ngày hiệu quả bắt đầu từ một ý chí mạnh mẽ!</p>
      <p class="motivation">Luôn tiến lên phía trước, thành công đang đợi bạn!</p>
      <h2>Đăng nhập bằng mã code</h2>
      <input type="text" id="code-input" placeholder="Nhập mã code" />
      <br />
      <input type="text" id="pt-name-input" placeholder="Nhập tên PT" style="margin-top: 10px;" />
      <br /><br />
      <button onclick="checkCode()">Đăng nhập</button>
    </div>
    <div id="main-container" style="display: none">
      <!-- Thêm 3 ô nhập liệu mới, giữ lại chỉ hướng dẫn trong placeholder, xóa tooltip -->
      <div class="monthly-inputs">
        <label>Rev Moth: <input type="text" id="rev-moth" placeholder="MTD REV / CM (e.g., 100/12)"></label>
        <label>Suppl Moth: <input type="text" id="suppl-moth" placeholder="Nhập Suppl Moth"></label>
        <label>Session Moth: <input type="text" id="session-moth" placeholder="Nhập Session Moth"></label>
      </div>
      <h2>Bảng Công việc Hàng Ngày</h2>
      <table>
        <thead>
          <tr>
            <th>Khung giờ</th>
            <th>Loại công việc</th>
            <th>Chi tiết (nếu có)</th>
          </tr>
        </thead>
        <tbody>
          <script>
            const timeSlots = [
              "06-07", "07-08", "08-09", "09-10", "10-11", "11-12", "12-13",
              "13-14", "14-15", "15-16", "16-17", "17-18", "18-19", "19-20", "20-21"
            ];

            timeSlots.forEach((slot) => {
              document.write(`
                <tr id="row-${slot}">
                  <td>${slot.split('-')[0]}h:</td>
                  <td>
                    <select onchange="changeRowColor(this, 'row-${slot}'); showDetails(this, 'details-${slot}');">
                      <option value="">Chọn loại công việc</option>
                      <option value="PT">PT</option>
                      <option value="APPT">APPT</option>
                      <option value="SETUP RN">SETUP RN</option>
                      <option value="OFF">OFF</option>
                      <option value="Gọi ĐT">Gọi ĐT</option>
                      <option value="Tập Luyện">Tập Luyện</option>
                      <option value="Giờ FL">Giờ FL</option>
                      <option value="Giờ ăn">Giờ ăn</option>
                      <option value="Đi Floor khách">Đi Floor khách</option>
                      <option value="Tùy chọn">Tùy chọn</option>
                    </select>
                  </td>
                  <td>
                    <div id="details-${slot}" class="details-container">
                      <div class="pt-info hidden">
                        <input type="text" placeholder="Họ và tên khách hàng">
                      </div>
                      <div class="appt-info hidden">
                        <input type="text" placeholder="Họ và tên khách hàng">
                        <input type="text" placeholder="Số điện thoại">
                      </div>
                      <div class="setup-info hidden">
                        <input type="text" placeholder="Họ và tên khách hàng">
                        <input type="number" placeholder="Số tiền setup">
                      </div>
                      <div class="custom-info hidden">
                        <input type="text" placeholder="Ghi chú tùy chọn">
                      </div>
                    </div>
                  </td>
                </tr>
              `);
            });
          </script>
        </tbody>
      </table>
      <div class="summary">
        <h3>Tổng hợp cuối ngày</h3>
        <p>Tổng số buổi PT: <span id="total-pt">0</span></p>
        <p>Tổng số APPT: <span id="total-appt">0</span></p>
        <p>Tổng số SETUP RN: <span id="total-setup">0</span></p>
        <p>Tổng số Gọi ĐT: <span id="total-call">0</span></p>
        <p>Tổng số Tập Luyện: <span id="total-train">0</span></p>
        <p>Tổng số Giờ FL: <span id="total-fl">0</span></p>
        <p>Tổng số Giờ ăn: <span id="total-eat">0</span></p>
        <p>Tổng số Đi Floor khách: <span id="total-floor">0</span></p>
        <p>Tổng số Tùy chọn: <span id="total-custom">0</span></p>
      </div>
      <div style="text-align: center; margin: 20px">
        <button id="submit-btn" onclick="copyReport()">Copy Báo cáo</button>
      </div>
      <div id="notification"></div>
    </div>

    <script>
      function checkCode() {
        const code = document.getElementById("code-input").value;
        const ptName = document.getElementById("pt-name-input").value;
        const codePattern = /^[0-9]{5}$/;
        if (codePattern.test(code) && ptName.trim()) {
          document.getElementById("login-container").style.display = "none";
          document.getElementById("main-container").style.display = "block";
        } else {
          alert("Mã code phải là 5 chữ số và tên PT không được để trống!");
        }
      }

      function changeRowColor(selectElement, rowId) {
        const value = selectElement.value;
        const row = document.getElementById(rowId);
        row.classList.remove("pt-row", "appt-row", "setup-row", "off-row", "call-row", "train-row", "fl-row", "eat-row", "floor-row", "custom-row");
        if (value === "PT") row.classList.add("pt-row");
        if (value === "APPT") row.classList.add("appt-row");
        if (value === "SETUP RN") row.classList.add("setup-row");
        if (value === "OFF") row.classList.add("off-row");
        if (value === "Gọi ĐT") row.classList.add("call-row");
        if (value === "Tập Luyện") row.classList.add("train-row");
        if (value === "Giờ FL") row.classList.add("fl-row");
        if (value === "Giờ ăn") row.classList.add("eat-row");
        if (value === "Đi Floor khách") row.classList.add("floor-row");
        if (value === "Tùy chọn") row.classList.add("custom-row");
        updateSummary();
      }

      function showDetails(selectElement, detailsId) {
        const value = selectElement.value;
        const detailsDiv = document.getElementById(detailsId);
        detailsDiv.querySelectorAll(".pt-info, .appt-info, .setup-info, .custom-info").forEach((div) => {
          div.classList.add("hidden");
        });
        if (value === "PT") {
          detailsDiv.querySelector(".pt-info").classList.remove("hidden");
        } else if (value === "APPT") {
          detailsDiv.querySelector(".appt-info").classList.remove("hidden");
        } else if (value === "SETUP RN") {
          detailsDiv.querySelector(".setup-info").classList.remove("hidden");
        } else if (value === "Tùy chọn") {
          detailsDiv.querySelector(".custom-info").classList.remove("hidden");
        }
      }

      function updateSummary() {
        let totalPT = 0, totalAPPT = 0, totalSETUP = 0, totalCall = 0, totalTrain = 0, totalFL = 0, totalEat = 0, totalFloor = 0, totalCustom = 0;
        document.querySelectorAll("select").forEach((select) => {
          if (select.value === "PT") totalPT++;
          if (select.value === "APPT") totalAPPT++;
          if (select.value === "SETUP RN") totalSETUP++;
          if (select.value === "Gọi ĐT") totalCall++;
          if (select.value === "Tập Luyện") totalTrain++;
          if (select.value === "Giờ FL") totalFL++;
          if (select.value === "Giờ ăn") totalEat++;
          if (select.value === "Đi Floor khách") totalFloor++;
          if (select.value === "Tùy chọn") totalCustom++;
        });
        document.getElementById("total-pt").innerText = totalPT;
        document.getElementById("total-appt").innerText = totalAPPT;
        document.getElementById("total-setup").innerText = totalSETUP;
        document.getElementById("total-call").innerText = totalCall;
        document.getElementById("total-train").innerText = totalTrain;
        document.getElementById("total-fl").innerText = totalFL;
        document.getElementById("total-eat").innerText = totalEat;
        document.getElementById("total-floor").innerText = totalFloor;
        document.getElementById("total-custom").innerText = totalCustom;
      }

      function copyReport() {
        const ptCode = document.getElementById("code-input").value;
        const ptName = document.getElementById("pt-name-input").value;
        const revMoth = document.getElementById("rev-moth").value || "";
        const supplMoth = document.getElementById("suppl-moth").value || "";
        const sessionMoth = document.getElementById("session-moth").value || "";
        const currentDate = new Date().toLocaleString("vi-VN", { 
          day: "2-digit", month: "2-digit", year: "numeric", hour: "2-digit", minute: "2-digit" 
        });
        
        let report = `PT Name: ${ptName}\nStaff Code: ${ptCode}\nBáo cáo CN: ${currentDate}\n`;
        report += `Rev Moth: ${revMoth}\nSuppl Moth: ${supplMoth}\nSession Moth: ${sessionMoth}\n\n`;
        
        timeSlots.forEach((slot) => {
          const select = document.querySelector(`#row-${slot} select`);
          const value = select.value || "";
          let details = "";
          
          if (value === "PT") {
            const customerName = document.querySelector(`#details-${slot} .pt-info input`)?.value || "";
            details = customerName ? `${value}/${customerName}` : value;
          } else if (value === "APPT") {
            const inputs = document.querySelectorAll(`#details-${slot} .appt-info input`);
            const customerName = inputs[0]?.value || "";
            const phone = inputs[1]?.value || "";
            details = customerName ? `${value}/${customerName}${phone ? `/${phone}` : ''}` : value;
          } else if (value === "SETUP RN") {
            const inputs = document.querySelectorAll(`#details-${slot} .setup-info input`);
            const customerName = inputs[0]?.value || "";
            const amount = inputs[1]?.value || "";
            details = customerName ? `${value}/${customerName}${amount ? `/${amount}` : ''}` : value;
          } else if (value === "Tùy chọn") {
            const customNote = document.querySelector(`#details-${slot} .custom-info input`)?.value || "";
            details = customNote ? `${value}/${customNote}` : value;
          } else {
            details = value;
          }
          
          report += `${slot.split('-')[0]}h: ${details}\n`;
        });

        // Tạo textarea ẩn để copy dữ liệu
        const tempTextarea = document.createElement("textarea");
        tempTextarea.value = report;
        document.body.appendChild(tempTextarea);
        tempTextarea.select();
        try {
          document.execCommand("copy");
          const notification = document.getElementById("notification");
          notification.textContent = "🎉 Báo cáo đã được copy thành công! Dán ngay nào! 🚀";
          notification.className = "copy-success";
          notification.style.display = "block";
          setTimeout(() => {
            notification.style.display = "none";
          }, 3000);
        } catch (err) {
          alert("Không thể copy dữ liệu. Vui lòng thử lại!");
          console.error("Copy failed:", err);
        } finally {
          document.body.removeChild(tempTextarea);
        }
      }
    </script>
  </body>
</html>
